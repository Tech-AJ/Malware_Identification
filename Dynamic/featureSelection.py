
#pip install feature_selector
#pip install --upgrade numpy

from feature_selector import FeatureSelector
import pandas as pd
data_train = pd.read_csv("../dynamicTrain.csv")
from sklearn.model_selection import train_test_split

X_all = data_train.drop(['Malware'], axis=1)
print(data_train.shape)
y_all = data_train['Malware']

num_test = 0.0
X_train, X_test, y_train, y_tst = train_test_split(X_all, y_all, test_size=num_test, random_state=23)

# Features are in train and labels are in train_labels
fs = FeatureSelector(data = X_all, labels = y_all)

fs.identify_all(selection_params = {'missing_threshold': 0.6, 'correlation_threshold': 0.98, 
                                    'task': 'classification', 'eval_metric': 'auc', 
                                     'cumulative_importance': 0.99})

print(fs.feature_importances.head())
train_removed = fs.remove(methods = 'all')
#print(train_removed.head())
# iterating the columns 
for col in train_removed.columns: 
    print(col) 
train_removed=pd.concat([y_all, train_removed], axis=1)
print(train_removed.head())
train_removed.to_csv("reduced.csv")
